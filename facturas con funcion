        select ai.date_invoice as fecha
        ,ai.x_sucursal_id as sucursal
		,right(coalesce(ai.reference,ai.number),length(coalesce(ai.reference,ai.number))-14) as nombrefac
		,textregexeq(right(coalesce(ai.reference,ai.number),length(coalesce(ai.reference,ai.number))-14),'^[[:digit:]]+(\.[[:digit:]]+)?$') as factura
		,CASE WHEN textregexeq(right(coalesce(ai.reference,ai.number),length(coalesce(ai.reference,ai.number))-14),'^[[:digit:]]+(\.[[:digit:]]+)?$') = TRUE THEN
			cast(right(coalesce(ai.reference,ai.number),(length(coalesce(ai.reference,ai.number))-14)) as Integer)
		ELSE ai.id *1000 end as correlativo
		,CASE WHEN afp.sv_contribuyente IS NULL THEN
			FALSE
		ELSE TRUE END AS contribuyente
        --,length(coalesce(ai.reference,ai.number))-14 as factura
        ,ai.state as estado
        --,FG.grupo
        --,afp.sv_region
        ,0.0 as Gravado
        ,0.0 as Exento
        ,0.0 as Iva
        ,0.0 as Retenido
        from account_invoice ai
		inner join account_fiscal_position afp on ai.fiscal_position_id=afp.id												
        

        