<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <template id="pos_sales_report_pdf_template">
      <t t-call="web.html_container">
        <t t-call="web.basic_layout">
          <div class="page">
            <t t-foreach="docs" t-as="o">
              <table style="width:100%;margin-top:15px;">
                <thead>
                  <div align="center" style="margin:0 auto;padding:0 auto;font-size:20px;margin-top:8px;">
                    <div style="font-size:13px;">
                      <t t-if="o.company_id.name">
                        <t t-esc="o.company_id.name"/><br/>
                      </t>
                      <t t-if="o.company_id.street">
                        <t t-esc="o.company_id.street"/><br/>
                      </t>
                      <t t-if="o.company_id.street2">
                        <t t-esc="o.company_id.street2"/>
                      </t>
                      <t t-if="o.company_id.city">
                        <t t-esc="o.company_id.city"/>
                      </t>
                      <t t-if="o.company_id.state_id.name">
                        <t t-esc="o.company_id.state_id.name"/>
                      </t>
                      <t t-if="o.company_id.country_id.name">
                        <t t-esc="o.company_id.country_id.name"/>
                      </t><br/>
                      <t t-if="o.company_id.phone">
                        Tel: <t t-esc="o.company_id.phone"/><br/>
                      </t>
                      <t t-if="o.company_id.email">
                        Email: <t t-esc="o.company_id.email"/><br/>
                      </t>
                      <t t-if="o.company_id.website">
                        Website: <t t-esc="o.company_id.website"/><br/>
                      </t>
                    </div>
                  </div>
                  <t t-set="pos_ids" t-value="data.get('form').get('pos_ids')"/>
                  <t t-set="today" t-value="data.get('form').get('end_date')"/>
                  --------------------------------------------------------
                  <strong>REPORTE Z</strong><br/>
                  --------------------------------------------------------
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        IMPRESION:
                      </td>
                      <td class="text-right">
                        <span t-esc="o.get_current_date_z()"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        HORA:
                      </td>
                      <td class="text-right">
                        <span t-esc="o.get_current_time_z()"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        FECHA:
                      </td>
                      <td class="text-right">
                        <span t-esc="o.get_eval_date(today)"/>
                      </td>
                    </tr>
                  </table>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        POS #
                      </td>
                      <td class="text-right">
                        <span t-esc="o.name"/>
                      </td>
                    </tr>
                    <!--tr>
                      <td class="text-left">
                        ESTADO:
                      </td>
                      <td class="text-right">
                        <span t-esc="o.state"/>
                      </td>
                    </tr-->
                    <t t-set="var" t-value="o.get_open_close_time(today)"/>
                    <tr>
                      <td class="text-left">
                        APERTURA:
                      </td>
                      <td class="text-right">
                        <!--span t-esc="o.get_eval_date(today)"/-->
                        <span t-esc="var.get('open_time')"/>
                        <!--span t-esc="o.get_session_time(o.start_at)"/-->
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        CIERRE:
                      </td>
                      <td class="text-right">
                        <!--span t-esc="o.get_eval_date(today)"/-->
                        <span t-esc="var.get('close_time')"/>
                        <!--span t-esc="o.get_session_time(o.stop_at)"/-->
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        USUARIO:
                      </td>
                      <td class="text-right">
                        <span t-esc="o.get_uid()"/>
                      </td>
                    </tr>
                  </table>
                  --------------------------------------------------------
                  <t t-set="datos" t-value="o.get_invoice_info_z(today)"/>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        FACTURAS: <span t-esc="datos.get('invran')"/><!--span t-esc="o.get_invoice_range_no_contr_z(pos_ids,today)"/>
                        <span t-esc="o.config_id.get_invoice_range_no_contr_z(today)"/-->
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS GRAVADAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(datos.get('gravado'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS EXENTAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(datos.get('excento'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS NO SUJETAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(datos.get('no_aplica'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right" colspan="2">
                        ----------------------
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL
                      </td>
                      <td class="text-right">
                        <!--t t-set="total1" t-value="datos.get('total_price')"/-->
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(datos.get('total_price'))"/>
                      </td>
                    </tr>
                  </table>
                  <t t-set="ccf" t-value="o.get_ccf_info_z(today)"/>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        CCF: <span t-esc="ccf.get('invran')"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS GRAVADAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ccf.get('gravado'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS EXENTAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ccf.get('excento'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS NO SUJETAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ccf.get('no_aplica'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right" colspan="2">
                        ----------------------
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL
                      </td>
                      <td class="text-right">
                        <!--t t-set="total2" t-value="o.get_total_sales_invoice_gravado_ccf() + o.get_total_sales_invoice_exento_ccf() + o.get_total_sales_invoice_no_aplica_ccf()"/-->
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ccf.get('total_price'))"/>
                      </td>
                    </tr>
                  </table>
                  <t t-set="ticket" t-value="o.get_tiquete_info_z(today)"/>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        TIQUETE: <span t-esc="ticket.get('tcktran')"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(o.get_total_sales_tickets_z(today) + o.get_total_returns_tickets_z(today))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        DEVOLUCIONES
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'-{0:.2f}'.format(o.get_total_returns_tickets_z(today))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS GRAVADAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ticket.get('gravado'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS EXENTAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ticket.get('excento'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL VENTAS NO SUJETAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ticket.get('no_aplica'))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right" colspan="2">
                        ----------------------
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL
                      </td>
                      <td class="text-right">
                        <!--t t-set="total3" t-value="o.get_total_sales_tickets()"/-->
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(ticket.get('total_price'))"/>
                        <!--span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(o.get_total_sales_tickets_z(today))"/-->
                      </td>
                    </tr>
                  </table>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">
                        RECIBO: <span t-esc="o.get_wallet_reciept_z(today)"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL RECARGAS
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(o.get_total_wallet_recharges_z(today))"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right" colspan="2">
                        ----------------------
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(o.get_total_wallet_recharges_z(today))"/>
                      </td>
                    </tr>
                  </table>
                  <div align="center">
                    --------------------------------------------------------
                    <br/>*DETALLE DE PAGOS*<br/>
                    --------------------------------------------------------
                  </div>
                </thead>
                <tbody class="invoice_tbody">
                  <t t-set="total1" t-value="0"/>
                  <t t-set="total2" t-value="0"/>
                  <table style="width:100%;margin-top:15px;">
                    <tr>
                      <td class="text-left">TIQUETE y RECIBO</td>
                    </tr>
                    <tr t-foreach="o.get_payments_z(today)" t-as="l">
                      <td class="text-left">
                        <span t-esc="l.get('name')"/>
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(l.get('sum'))"/>
                      </td>
                      <t t-set="total1" t-value="total1 + l.get('sum')"/>
                    </tr>
                    <tr><td></td></tr>
                    <tr>
                      <td class="text-left">FACTURA y CCF</td>
                    </tr>
                    <tr t-foreach="o.get_payments_invoice_z(today)" t-as="l">
                      <td class="text-left">
                        <span t-esc="l.get('name')"/>
                      </td>
                      <td class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(l.get('sum'))"/>
                      </td>
                      <t t-set="total2" t-value="total2 + l.get('sum')"/>
                    </tr>
                    <tr>
                      <td class="text-right" colspan="2">
                        ----------------------
                      </td>
                    </tr>
                    <tr>
                      <td class="text-left">
                        TOTAL
                      </td>
                      <td style="width:50%; !important" class="text-right">
                        <span t-field="o.currency_id.symbol"/><span t-esc="'{0:.2f}'.format(total1+total2)"/>
                      </td>
                    </tr>
                  </table><br/>
                </tbody>
                <tfoot>
                  <div style="font-size:13px;">
                    <t t-if="o.company_id.name">
                      <t t-esc="o.company_id.name"/><br/>
                    </t>
                    <t t-if="o.company_id.street">
                      <t t-esc="o.company_id.street"/><br/>
                    </t>
                    <t t-if="o.company_id.street2">
                      <t t-esc="o.company_id.street2"/>
                    </t>
                    <t t-if="o.company_id.city">
                      <t t-esc="o.company_id.city"/>
                    </t>
                    <t t-if="o.company_id.state_id.name">
                      <t t-esc="o.company_id.state_id.name"/>
                    </t>
                    <t t-if="o.company_id.country_id.name">
                      <t t-esc="o.company_id.country_id.name"/>
                    </t>
                  </div><br/>
                </tfoot>
              </table>
            </t>
          </div>
        </t>
      </t>
    </template>
  </data>
</odoo>
